---
title: 'Server运行中有用的命令'
permalink: /posts/2025/blog-post-8/
tags: 
---

## 心血

- 查看CPU占用情况： `sinfo -N -o "%N %C %c"`
    输出说明：
    - `%N`：节点名称（例如 gpu114, gpu115）
    - `%C`：CPU 分配状态，格式为 A/I/O/T（已分配/空闲/其他/总计核心数）
    - `%c`：每个节点的总 CPU 核心数
- sbatch会把任务分配到空闲的节点。（除非申请WLS）需要为不同compute node安排不同Gurobi license,

```shell
#!/bin/bash
#SBATCH --job-name=resourse-alloc-outside-box       # Name for your job
#SBATCH --ntasks=1               # Number of tasks
#SBATCH --cpus-per-task=8        # CPUs per task
#SBATCH --nodes=1								 # Request 1 compute node
#SBATCH --time=2-00:00:00        # Request 2 days runtime (D-HH:MM:SS)
#SBATCH --output=%j_output.log   # Save output to a log file
#SBATCH --error=%j_error.log

# 根据节点名称设置 GRB_LICENSE_FILE
echo $SLURM_NODELIST
if [ "$SLURM_NODELIST" == "gpu114" ]; then
    export GRB_LICENSE_FILE=/xxx/gurobi_node1.lic
elif [ "$SLURM_NODELIST" == "gpu115" ]; then
    export GRB_LICENSE_FILE=/xxx/gurobi_node2.lic
fi
```

- 指定compute node,
```shell
#SBATCH --nodelist=gpu115
```